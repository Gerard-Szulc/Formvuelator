var e=Object.assign;import{defineComponent as l,toRefs as d,openBlock as o,createBlock as n,createTextVNode as a,toDisplayString as t,createVNode as h,withModifiers as m,withScopeId as r,withDirectives as u,vModelText as s,pushScopeId as i,popScopeId as c,Fragment as p,renderList as g,renderSlot as I,resolveComponent as M,createCommentVNode as v}from"vue";var C=l({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:o,schema:n,id:a}=d(e);return{handleBlur:e=>{l.emit("blur",{value:e.target.value,model:o,schema:n,id:a,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:o,schema:n,id:a,originalEvent:e})},handleInput:e=>{l.emit("input",{value:e.target.value,model:o,schema:n,id:a,originalEvent:e})}}}});const B=r("data-v-1e643734")(((e,l,d,r,u,s)=>(o(),n("label",{for:e.id},[a(t(e.schema.label||"")+" ",1),h("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=m(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"]))},null,40,["id","type","value"])],8,["for"]))));C.render=B,C.__scopeId="data-v-1e643734";var x=l({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}}});const $=r("data-v-54e601bc")(((e,l,d,m,r,i)=>(o(),n("label",{for:e.id},[a(t(e.schema.label||"")+" ",1),u(h("textarea",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=l=>e.model[e.schema.model]=l)},null,8,["id"]),[[s,e.model[e.schema.model]]])],8,["for"]))));x.render=$,x.__scopeId="data-v-54e601bc";var y=l({name:"FormGroup",components:{},props:{schema:{},model:{},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(l){this.$emit("blur",e(e({},l),{groupModel:this.schema.model}))},handleChange(l){this.$emit("change-model",e(e({},l),{groupModel:this.schema.model}))},handleInput(l){this.$emit("input",e(e({},l),{groupModel:this.schema.model}))}}});const f=r("data-v-67a2e95e");i("data-v-67a2e95e");const b={class:"form-group"};c();const G=f(((e,l,d,h,m,r)=>(o(),n("div",b,[a(t(e.schema.label||"")+" ",1),(o(!0),n(p,null,g(e.localModel(),((d,h)=>(o(),n(p,null,[(o(!0),n(p,null,g(e.schema.items,(d=>(o(),n("div",{key:`group-${h}`,id:`${h}-${d.model}`},[a(t(d.model+d.type)+" ",1),I(e.$slots,"field",{id:`${e.id}-${d.model}-${h}`,model:e.localFieldModel(h),schema:d,index:h,onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChangeModel:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=(...l)=>e.handleInput&&e.handleInput(...l))})],8,["id"])))),128)),I(e.$slots,"button",{index:h})],64)))),256))]))));y.render=G,y.__scopeId="data-v-67a2e95e";var P=l({name:"FormField",components:{FormGroup:y,FormTextarea:x,FormInput:C},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blur",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("input",e)},handleInputGroupBlur(e,l,d){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[d.index,...e.schemaModelIndex||[]],this.$emit("blur",e,l,d)},handleGroupChange(e,l,d){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[d.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,l,d)},handleGroupInput(e,l,d){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[d.index,...e.schemaModelIndex||[]],this.$emit("input",e,l,d)},addGroupElement(e,l,d){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[d.index,...e.schemaModelIndex||[]],this.$emit("add-group-element",e,l,d)}}});const F=r("data-v-0131554d");i("data-v-0131554d");const _={class:"form-field"};c();const k=F(((e,l,d,a,t,m)=>{const r=M("form-input"),u=M("form-textarea"),s=M("_self"),i=M("form-group");return o(),n("div",_,["input"===e.schema.type?(o(),n(r,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):v("",!0),"textarea"===e.schema.type?(o(),n(u,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):v("",!0),"group"===e.schema.type?(o(),n(i,{key:2,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},{field:F((l=>[h(s,{id:l.id,model:l.model,schema:l.schema,onBlur:d=>e.handleInputGroupBlur(d,e.schema,l),onChangeModel:d=>e.handleGroupChange(d,e.schema,l),onInput:d=>e.handleGroupInput(d,e.schema,l),onAddGroupElement:d=>e.addGroupElement(d,e.schema,l)},null,8,["id","model","schema","onBlur","onChangeModel","onInput","onAddGroupElement"])])),button:F((l=>[h("button",{onClick:()=>e.addGroupElement({},e.schema,l)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlur","onChangeModel","onInput"])):v("",!0)])}));P.render=k,P.__scopeId="data-v-0131554d";var q=l({name:"FormVuelator",components:{FormField:P},props:{model:{required:!0},schema:{required:!0}},emits:["model-change"],setup:(l,o)=>{const{model:n,schema:a,id:t}=d(l),h=(l,d,o,n,a)=>{let t,m;[t,...d]=d,[m,...o]=o;let r={};t&&0===d.length&&(r[n]=a.value),l.hasOwnProperty(t)?l[t][m]?l[t][m]=e(e({},l[t][m]),r):Array.isArray(l[t])?l[t].push(r):l[t]=[].push(r):(l[t]=[],l[t].hasOwnProperty(m)?l[t]=[].push(r):l[t][m]=r),0!==d.length?h(l[t][m],d,o,n,a):l[t][m]=e(e({},l[t][m]),r)};return{model:n,schema:a,handleClick:()=>{console.log(n.value)},handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e)},handleInput:e=>{let l=n.value,d=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?h(n.value,e.schemaModelPath,e.schemaModelIndex,d,e):(l[d]=e.value,o.emit("model-change",l))},handleAddGroup:e=>{console.log("add",e),e.schemaModelPath,e.schemaModelIndex},id:t}}});q.render=function(e,l,d,a,t,r){const u=M("form-field");return o(),n(p,null,[h("button",{onClick:l[1]||(l[1]=m(((...l)=>e.handleClick&&e.handleClick(...l)),["prevent"]))}),(o(!0),n(p,null,g(e.schema,((l,d)=>(o(),n("div",{key:`root-field-${d}`},[h(u,{model:e.model,schema:l,id:l.model,onBlur:e.handleBlur,onChangeModel:e.handleChange,onInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlur","onChangeModel","onInput","onAddGroupElement"])])))),128))],64)};var E=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",FormVueLator:q});export default e=>{for(let l in E)e.use(E[l])};export{q as FormVueLator};
