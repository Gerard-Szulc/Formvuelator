var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,t=(l,a,d)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[a]=d,m=(e,l)=>{for(var a in l||(l={}))o.call(l,a)&&t(e,a,l[a]);if(d)for(var a of d(l))n.call(l,a)&&t(e,a,l[a]);return e},s=(e,d)=>l(e,a(d));import{defineComponent as h,toRefs as r,openBlock as u,createBlock as c,createVNode as i,toDisplayString as p,withModifiers as v,withScopeId as g,pushScopeId as I,popScopeId as y,createTextVNode as b,Fragment as M,renderList as f,renderSlot as C,withDirectives as B,createCommentVNode as x,vModelSelect as $,resolveComponent as P}from"vue";var F=h({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:a,schema:d,id:o}=r(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:a,schema:d,id:o,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:a,schema:d,id:o,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:a,schema:d,id:o,originalEvent:e})}}}});const O=g("data-v-ce4071b4")(((e,l,a,d,o,n)=>(u(),c("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[i("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},p(e.schema.label||""),11,["for"]),i("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=v(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","type","value"])],2))));F.render=O,F.__scopeId="data-v-ce4071b4";var E=h({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:a,schema:d,id:o}=r(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:a,schema:d,id:o,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:a,schema:d,id:o,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:a,schema:d,id:o,originalEvent:e})}}}});const q=g("data-v-3c6bf935")(((e,l,a,d,o,n)=>(u(),c("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[i("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},p(e.schema.label||""),11,["for"]),i("textarea",{id:e.id,value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=v(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","value"])],2))));E.render=q,E.__scopeId="data-v-3c6bf935";var G=h({name:"FormGroup",components:{},props:{schema:{type:Object,default:()=>({})},model:{type:Object,default:()=>({})},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",s(m({},e),{groupModel:this.schema.model}))},handleChange(e){this.$emit("change-model",s(m({},e),{groupModel:this.schema.model}))},handleInput(e){this.$emit("input",s(m({},e),{groupModel:this.schema.model}))}}});const j=g("data-v-828ccd04");I("data-v-828ccd04");const w={class:"form-group"};y();const A=j(((e,l,a,d,o,n)=>(u(),c("div",w,[b(p(e.schema.label||"")+" ",1),(u(!0),c(M,null,f(e.localModel(),((a,d)=>(u(),c(M,null,[(u(!0),c(M,null,f(e.schema.items,(a=>(u(),c("div",{key:`group-${d}`,id:`${d}-${a.model}`},[C(e.$slots,"field",{id:`${e.id}-${a.model}-${d}`,model:e.localFieldModel(d),schema:a,index:d,onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChangeModel:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=(...l)=>e.handleInput&&e.handleInput(...l))},void 0,!0)],8,["id"])))),128)),C(e.$slots,"button",{index:d},void 0,!0)],64)))),256))]))));G.render=A,G.__scopeId="data-v-828ccd04";var _=h({name:"FormSelect",props:{model:{type:Object,default:()=>({}),required:!0},schema:{type:Object,default:()=>({}),required:!0},id:{type:String,required:!0}},computed:{value:{get(){return this.schema.multiple?this.schema.multipleAsObjects?(this.model[this.schema.model]||[]).map((e=>e[this.schema.optionValueKey||"value"])):this.model[this.schema.model]||[]:this.model[this.schema.model]||null},set:(e,...l)=>e}},setup(e,l){const{model:a,schema:d,id:o}=r(e),n=e=>Array(...e).reduce(((e,l)=>(e.push((e=>{if(d.value.multipleAsObjects){let l={};return l[d.value.optionValueKey||"value"]=e.value,l[d.value.optionLabelKey||"label"]=e.label,l}return e.value})(l)),e)),[]),t=e=>d.value.multiple?n(e):e,m=(e,n,m=null)=>{l.emit(e,{value:t(n),model:a,schema:d,id:o,originalEvent:m})};return{handleBlur:e=>{m("blured",d.value.multiple?e.target.selectedOptions:e.target.value,e)},handleChange:e=>{m("change-model",d.value.multiple?e.target.selectedOptions:e.target.value,e)},emitEvent:m}}});const k=g("data-v-e7021456");I("data-v-e7021456");const S={key:0,value:null};y();const V=k(((e,l,a,d,o,n)=>(u(),c("label",{for:e.id},[b(p(e.schema.label||"")+" ",1),B(i("select",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=l=>e.value=l),value:e.value,name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple,disabled:e.schema.disabled,required:e.schema.required,onBlur:l[2]||(l[2]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[3]||(l[3]=v(((...l)=>e.handleChange&&e.handleChange(...l)),["stop"]))},[e.schema.multiple?x("",!0):(u(),c("option",S,p(e.schema.nothingSelectedLabel||"Nothing selected"),1)),(u(!0),c(M,null,f(e.schema.options,((l,a)=>(u(),c("option",{key:`${e.id}-${e.schema.model}-${l[e.schema.optionValueKey||"value"]}-temp`,value:l[e.schema.optionValueKey||"value"]},p(l[e.schema.optionLabelKey||"label"]),9,["value"])))),128))],40,["id","value","name","size","multiple","disabled","required"]),[[$,e.value]])],8,["for"]))));_.render=V,_.__scopeId="data-v-e7021456";var K=h({name:"FormField",components:{FormSelect:_,FormGroup:G,FormTextarea:E,FormInput:F},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blured",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("form-input",e)},handleInputGroupBlur(e,l,a){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[a.index,...e.schemaModelIndex||[]],this.$emit("blured",e,l,a)},handleGroupChange(e,l,a){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[a.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,l,a)},handleGroupInput(e,l,a){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[a.index,...e.schemaModelIndex||[]],this.$emit("form-input",e,l,a)},addGroupElement(e,l,a){let d={};d.schemaModelPath=[l.model,...d.schemaModelPath||[]],d.schemaModelIndex=[a.index,...d.schemaModelIndex||[]],this.$emit("add-group-element",{customEvent:d,groupSchema:l,slotProps:a})}}});const z=g("data-v-d60fc254");I("data-v-d60fc254");const L={class:"form-field"};y();const T=z(((e,l,a,d,o,n)=>{const t=P("form-input"),m=P("form-textarea"),s=P("form-select"),h=P("form-field",!0),r=P("form-group");return u(),c("div",L,["input"===e.schema.type?(u(),c(t,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):x("",!0),"textarea"===e.schema.type?(u(),c(m,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):x("",!0),"select"===e.schema.type?(u(),c(s,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange},null,8,["id","model","schema","onBlured","onChangeModel"])):x("",!0),"group"===e.schema.type?(u(),c(r,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},{field:z((l=>[i(h,{id:l.id,model:l.model,schema:l.schema,onBlured:a=>e.handleInputGroupBlur(a,e.schema,l),onChangeModel:a=>e.handleGroupChange(a,e.schema,l),onFormInput:a=>e.handleGroupInput(a,e.schema,l),onAddGroupElement:a=>e.addGroupElement(a,e.schema,l)},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])),button:z((l=>[i("button",{onClick:a=>e.addGroupElement(a,e.schema,l)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlured","onChangeModel","onFormInput"])):x("",!0)])}));K.render=T,K.__scopeId="data-v-d60fc254";var D=h({name:"FormVuelator",components:{FormField:K},props:{model:{type:Object,required:!0},schema:{type:Array,required:!0},id:{}},emits:["change-model","model-created-property","model-created-index"],setup:(e,l)=>{const{model:a,schema:d,id:o}=r(e),n=(e,a,d,o,t)=>{let s,h;[s,...a]=a,[h,...d]=d;let r={};s&&0===a.length&&(r[o]=t.value),console.log("trpp",r,e,a,d,o,t),e.hasOwnProperty(s)?e[s][h]?e[s][h]=m(m({},e[s][h]),r):(Array.isArray(e[s])?e[s].push(r):(e[s]=[],e[s]=e[s].push(r)),l.emit("model-created-index",{currentModel:e,pathElement:s,indexElement:h,schema:t.schema.value}),console.log("trollo1")):(e[s]=[],e[s].hasOwnProperty(h)?(e[s]=[],e[s]=e[s].push(r),l.emit("model-created-property",{currentModel:e,pathElement:s,indexElement:h,schema:t.schema.value}),console.log("trollo2")):e[s][h]=r),0!==a.length?n(e[s][h],a,d,o,t):e[s][h]=m(m({},e[s][h]),r)};return{model:a,schema:d,handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e);let d=a.value,o=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?n(a.value,e.schemaModelPath,e.schemaModelIndex,o,e):(d[o]=e.value,l.emit("change-model",d,e.schema.value))},handleInput:e=>{console.log(e);let d=a.value,o=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?n(a.value,e.schemaModelPath,e.schemaModelIndex,o,e):(console.log(e.value),d[o]=e.value,l.emit("change-model",d,e.schema.value))},handleAddGroup:e=>{console.log("add",e),e.customEvent.schemaModelPath,e.customEvent.schemaModelIndex},id:o}}});D.render=function(e,l,a,d,o,n){const t=P("form-field");return u(!0),c(M,null,f(e.schema,((l,a)=>(u(),c("div",{key:`root-field-${a}`},[i(t,{model:e.model,schema:l,id:l.model,onBlured:e.handleBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])))),128)};export{D as FormVuelator};
