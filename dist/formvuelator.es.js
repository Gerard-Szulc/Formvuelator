var e=Object.assign;import{defineComponent as l,toRefs as a,openBlock as d,createBlock as o,createVNode as n,toDisplayString as t,withModifiers as m,withScopeId as s,pushScopeId as h,popScopeId as r,createTextVNode as u,Fragment as c,renderList as i,renderSlot as p,withDirectives as g,createCommentVNode as v,vModelSelect as I,resolveComponent as M}from"vue";var y=l({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:d,schema:o,id:n}=a(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:d,schema:o,id:n,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:d,schema:o,id:n,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:d,schema:o,id:n,originalEvent:e})}}}});const C=s("data-v-24a7c550")(((e,l,a,s,h,r)=>(d(),o("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[n("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},t(e.schema.label||""),11,["for"]),n("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=m(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","type","value"])],2))));y.render=C,y.__scopeId="data-v-24a7c550";var B=l({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:d,schema:o,id:n}=a(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:d,schema:o,id:n,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:d,schema:o,id:n,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:d,schema:o,id:n,originalEvent:e})}}}});const b=s("data-v-e1e63c32")(((e,l,a,s,h,r)=>(d(),o("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[n("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},t(e.schema.label||""),11,["for"]),n("textarea",{id:e.id,value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=m(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","value"])],2))));B.render=b,B.__scopeId="data-v-e1e63c32";var f=l({name:"FormGroup",components:{},props:{schema:{},model:{},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(l){this.$emit("blur",e(e({},l),{groupModel:this.schema.model}))},handleChange(l){this.$emit("change-model",e(e({},l),{groupModel:this.schema.model}))},handleInput(l){this.$emit("input",e(e({},l),{groupModel:this.schema.model}))}}});const x=s("data-v-6706e92e");h("data-v-6706e92e");const $={class:"form-group"};r();const F=x(((e,l,a,n,m,s)=>(d(),o("div",$,[u(t(e.schema.label||"")+" ",1),(d(!0),o(c,null,i(e.localModel(),((a,n)=>(d(),o(c,null,[(d(!0),o(c,null,i(e.schema.items,(a=>(d(),o("div",{key:`group-${n}`,id:`${n}-${a.model}`},[p(e.$slots,"field",{id:`${e.id}-${a.model}-${n}`,model:e.localFieldModel(n),schema:a,index:n,onBlur:l[1]||(l[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChangeModel:l[2]||(l[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:l[3]||(l[3]=(...l)=>e.handleInput&&e.handleInput(...l))})],8,["id"])))),128)),p(e.$slots,"button",{index:n})],64)))),256))]))));f.render=F,f.__scopeId="data-v-6706e92e";var E=l({name:"FormSelect",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},computed:{value:{get(){return this.schema.multiple?this.schema.multipleAsObjects?(this.model[this.schema.model]||[]).map((e=>e[this.schema.optionValueKey||"value"])):this.model[this.schema.model]||[]:this.model[this.schema.model]||null},set:(e,...l)=>e}},setup(e,l){const{model:d,schema:o,id:n}=a(e),t=e=>Array(...e).reduce(((e,l)=>(e.push((e=>{if(o.value.multipleAsObjects){let l={};return l[o.value.optionValueKey||"value"]=e.value,l[o.value.optionLabelKey||"label"]=e.label,l}return e.value})(l)),e)),[]),m=e=>o.value.multiple?t(e):e,s=(e,a,t=null)=>{l.emit(e,{value:m(a),model:d,schema:o,id:n,originalEvent:t})};return{handleBlur:e=>{s("blured",o.value.multiple?e.target.selectedOptions:e.target.value,e)},handleChange:e=>{s("change-model",o.value.multiple?e.target.selectedOptions:e.target.value,e)},emitEvent:s}}});const P=s("data-v-e700cc5c");h("data-v-e700cc5c");const q={key:0,value:null};r();const G=P(((e,l,a,s,h,r)=>(d(),o("label",{for:e.id},[u(t(e.schema.label||"")+" ",1),g(n("select",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=l=>e.value=l),value:e.value,name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple,disabled:e.schema.disabled,required:e.schema.required,onBlur:l[2]||(l[2]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:l[3]||(l[3]=m(((...l)=>e.handleChange&&e.handleChange(...l)),["stop"]))},[e.schema.multiple?v("",!0):(d(),o("option",q,t(e.schema.nothingSelectedLabel||"Nothing selected"),1)),(d(!0),o(c,null,i(e.schema.options,((l,a)=>(d(),o("option",{key:`${e.id}-${e.schema.model}-${l[e.schema.optionValueKey||"value"]}-temp`,value:l[e.schema.optionValueKey||"value"]},t(l[e.schema.optionLabelKey||"label"]),9,["value"])))),128))],40,["id","value","name","size","multiple","disabled","required"]),[[I,e.value]])],8,["for"]))));E.render=G,E.__scopeId="data-v-e700cc5c";var O=l({name:"FormField",components:{FormSelect:E,FormGroup:f,FormTextarea:B,FormInput:y},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blured",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("form-input",e)},handleInputGroupBlur(e,l,a){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[a.index,...e.schemaModelIndex||[]],this.$emit("blured",e,l,a)},handleGroupChange(e,l,a){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[a.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,l,a)},handleGroupInput(e,l,a){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[a.index,...e.schemaModelIndex||[]],this.$emit("form-input",e,l,a)},addGroupElement(e,l,a){let d={};d.schemaModelPath=[l.model,...d.schemaModelPath||[]],d.schemaModelIndex=[a.index,...d.schemaModelIndex||[]],this.$emit("add-group-element",{customEvent:d,groupSchema:l,slotProps:a})}}});const A=s("data-v-c4fba7d4");h("data-v-c4fba7d4");const _={class:"form-field"};r();const k=A(((e,l,a,t,m,s)=>{const h=M("form-input"),r=M("form-textarea"),u=M("form-select"),c=M("_self"),i=M("form-group");return d(),o("div",_,["input"===e.schema.type?(d(),o(h,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):v("",!0),"textarea"===e.schema.type?(d(),o(r,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):v("",!0),"select"===e.schema.type?(d(),o(u,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange},null,8,["id","model","schema","onBlured","onChangeModel"])):v("",!0),"group"===e.schema.type?(d(),o(i,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},{field:A((l=>[n(c,{id:l.id,model:l.model,schema:l.schema,onBlured:a=>e.handleInputGroupBlur(a,e.schema,l),onChangeModel:a=>e.handleGroupChange(a,e.schema,l),onFormInput:a=>e.handleGroupInput(a,e.schema,l),onAddGroupElement:a=>e.addGroupElement(a,e.schema,l)},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])),button:A((l=>[n("button",{onClick:a=>e.addGroupElement(a,e.schema,l)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlured","onChangeModel","onFormInput"])):v("",!0)])}));O.render=k,O.__scopeId="data-v-c4fba7d4";var w=l({name:"FormVuelator",components:{FormField:O},props:{model:{type:Object,required:!0},schema:{type:Array,required:!0},id:{}},emits:["change-model","model-created-property","model-created-index"],setup:(l,d)=>{const{model:o,schema:n,id:t}=a(l),m=(l,a,o,n,t)=>{let s,h;[s,...a]=a,[h,...o]=o;let r={};s&&0===a.length&&(r[n]=t.value),console.log("trpp",r,l,a,o,n,t),l.hasOwnProperty(s)?l[s][h]?l[s][h]=e(e({},l[s][h]),r):(Array.isArray(l[s])?l[s].push(r):l[s]=[].push(r),d.emit("model-created-index",{currentModel:l,pathElement:s,indexElement:h,schema:t.schema.value}),console.log("trollo1")):(l[s]=[],l[s].hasOwnProperty(h)?(l[s]=[].push(r),d.emit("model-created-property",{currentModel:l,pathElement:s,indexElement:h,schema:t.schema.value}),console.log("trollo2")):l[s][h]=r),0!==a.length?m(l[s][h],a,o,n,t):l[s][h]=e(e({},l[s][h]),r)};return{model:o,schema:n,handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e);let l=o.value,a=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?m(o.value,e.schemaModelPath,e.schemaModelIndex,a,e):(l[a]=e.value,d.emit("change-model",l,e.schema.value))},handleInput:e=>{console.log(e);let l=o.value,a=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?m(o.value,e.schemaModelPath,e.schemaModelIndex,a,e):(console.log(e.value),l[a]=e.value,d.emit("change-model",l,e.schema.value))},handleAddGroup:e=>{console.log("add",e),e.customEvent.schemaModelPath,e.customEvent.schemaModelIndex},id:t}}});w.render=function(e,l,a,t,m,s){const h=M("form-field");return d(!0),o(c,null,i(e.schema,((l,a)=>(d(),o("div",{key:`root-field-${a}`},[n(h,{model:e.model,schema:l,id:l.model,onBlured:e.handleBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])))),128)};export{w as FormVuelator};
