var __assign=Object.assign;!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).FormVuelator={},e.Vue)}(this,(function(e,o){"use strict";var n=o.defineComponent({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,n){const{model:l,schema:d,id:a}=o.toRefs(e);return{handleBlur:e=>{n.emit("blur",{value:e.target.value,model:l,schema:d,id:a,originalEvent:e})},handleChange:e=>{n.emit("change-model",{value:e.target.value,model:l,schema:d,id:a,originalEvent:e})},handleInput:e=>{n.emit("input",{value:e.target.value,model:l,schema:d,id:a,originalEvent:e})}}}});const l=o.withScopeId("data-v-1e643734")(((e,n,l,d,a,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.createVNode("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:n[1]||(n[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:n[2]||(n[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:n[3]||(n[3]=o.withModifiers(((...o)=>e.handleInput&&e.handleInput(...o)),["stop"]))},null,40,["id","type","value"])],8,["for"]))));n.render=l,n.__scopeId="data-v-1e643734";var d=o.defineComponent({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}}});const a=o.withScopeId("data-v-54e601bc")(((e,n,l,d,a,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.withDirectives(o.createVNode("textarea",{id:e.id,"onUpdate:modelValue":n[1]||(n[1]=o=>e.model[e.schema.model]=o)},null,8,["id"]),[[o.vModelText,e.model[e.schema.model]]])],8,["for"]))));d.render=a,d.__scopeId="data-v-54e601bc";var t=o.defineComponent({name:"FormGroup",components:{},props:{schema:{},model:{},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",__assign(__assign({},e),{groupModel:this.schema.model}))},handleChange(e){this.$emit("change-model",__assign(__assign({},e),{groupModel:this.schema.model}))},handleInput(e){this.$emit("input",__assign(__assign({},e),{groupModel:this.schema.model}))}}});const r=o.withScopeId("data-v-67a2e95e");o.pushScopeId("data-v-67a2e95e");const m={class:"form-group"};o.popScopeId();const h=r(((e,n,l,d,a,t)=>(o.openBlock(),o.createBlock("div",m,[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.localModel(),((l,d)=>(o.openBlock(),o.createBlock(o.Fragment,null,[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.items,(l=>(o.openBlock(),o.createBlock("div",{key:`group-${d}`,id:`${d}-${l.model}`},[o.createTextVNode(o.toDisplayString(l.model+l.type)+" ",1),o.renderSlot(e.$slots,"field",{id:`${e.id}-${l.model}-${d}`,model:e.localFieldModel(d),schema:l,index:d,onBlur:n[1]||(n[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChangeModel:n[2]||(n[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:n[3]||(n[3]=(...o)=>e.handleInput&&e.handleInput(...o))})],8,["id"])))),128)),o.renderSlot(e.$slots,"button",{index:d})],64)))),256))]))));t.render=h,t.__scopeId="data-v-67a2e95e";var s=o.defineComponent({name:"FormField",components:{FormGroup:t,FormTextarea:d,FormInput:n},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blur",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("input",e)},handleInputGroupBlur(e,o,n){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[n.index,...e.schemaModelIndex||[]],this.$emit("blur",e,o,n)},handleGroupChange(e,o,n){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[n.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,o,n)},handleGroupInput(e,o,n){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[n.index,...e.schemaModelIndex||[]],this.$emit("input",e,o,n)},addGroupElement(e,o,n){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[n.index,...e.schemaModelIndex||[]],this.$emit("add-group-element",e,o,n)}}});const c=o.withScopeId("data-v-0131554d");o.pushScopeId("data-v-0131554d");const i={class:"form-field"};o.popScopeId();const u=c(((e,n,l,d,a,t)=>{const r=o.resolveComponent("form-input"),m=o.resolveComponent("form-textarea"),h=o.resolveComponent("_self"),s=o.resolveComponent("form-group");return o.openBlock(),o.createBlock("div",i,["input"===e.schema.type?(o.openBlock(),o.createBlock(r,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0),"textarea"===e.schema.type?(o.openBlock(),o.createBlock(m,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0),"group"===e.schema.type?(o.openBlock(),o.createBlock(s,{key:2,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},{field:c((n=>[o.createVNode(h,{id:n.id,model:n.model,schema:n.schema,onBlur:o=>e.handleInputGroupBlur(o,e.schema,n),onChangeModel:o=>e.handleGroupChange(o,e.schema,n),onInput:o=>e.handleGroupInput(o,e.schema,n),onAddGroupElement:o=>e.addGroupElement(o,e.schema,n)},null,8,["id","model","schema","onBlur","onChangeModel","onInput","onAddGroupElement"])])),button:c((n=>[o.createVNode("button",{onClick:()=>e.addGroupElement({},e.schema,n)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0)])}));s.render=u,s.__scopeId="data-v-0131554d";var p=o.defineComponent({name:"FormVuelator",components:{FormField:s},props:{model:{required:!0},schema:{required:!0}},emits:["model-changed"],setup:(e,n)=>{const{model:l,schema:d,id:a}=o.toRefs(e),t=(e,o,n,l,d)=>{let a,r;[a,...o]=o,[r,...n]=n;let m={};a&&0===o.length&&(m[l]=d.value),e.hasOwnProperty(a)?e[a][r]?e[a][r]=__assign(__assign({},e[a][r]),m):Array.isArray(e[a])?e[a].push(m):e[a]=[].push(m):(e[a]=[],e[a].hasOwnProperty(r)?e[a]=[].push(m):e[a][r]=m),0!==o.length?t(e[a][r],o,n,l,d):e[a][r]=__assign(__assign({},e[a][r]),m)};return{model:l,schema:d,handleClick:()=>{console.log(l.value)},handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e)},handleInput:e=>{let o=l.value,d=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(l.value,e.schemaModelPath,e.schemaModelIndex,d,e):(o[d]=e.value,n.emit("model-change",o))},handleAddGroup:e=>{console.log("add",e),e.schemaModelPath,e.schemaModelIndex},id:a}}});p.render=function(e,n,l,d,a,t){const r=o.resolveComponent("form-field");return o.openBlock(),o.createBlock(o.Fragment,null,[o.createVNode("button",{onClick:n[1]||(n[1]=o.withModifiers(((...o)=>e.handleClick&&e.handleClick(...o)),["prevent"]))}),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema,((n,l)=>(o.openBlock(),o.createBlock("div",{key:`root-field-${l}`},[o.createVNode(r,{model:e.model,schema:n,id:n.model,onBlur:e.handleBlur,onChangeModel:e.handleChange,onInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlur","onChangeModel","onInput","onAddGroupElement"])])))),128))],64)};var g=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",FormVueLator:p});e.FormVueLator=p,e.default=e=>{for(let o in g)e.use(g[o])},Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
