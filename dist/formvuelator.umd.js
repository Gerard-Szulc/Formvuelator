var __assign=Object.assign;!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).FormVuelator={},e.Vue)}(this,(function(e,o){"use strict";var l=o.defineComponent({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:n,schema:a,id:d}=o.toRefs(e);return{handleBlur:e=>{l.emit("blur",{value:e.target.value,model:n,schema:a,id:d,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:n,schema:a,id:d,originalEvent:e})},handleInput:e=>{l.emit("input",{value:e.target.value,model:n,schema:a,id:d,originalEvent:e})}}}});const n=o.withScopeId("data-v-b676277e")(((e,l,n,a,d,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.createVNode("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=o.withModifiers(((...o)=>e.handleInput&&e.handleInput(...o)),["stop"]))},null,40,["id","type","value"])],8,["for"]))));l.render=n,l.__scopeId="data-v-b676277e";var a=o.defineComponent({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}}});const d=o.withScopeId("data-v-54e601bc")(((e,l,n,a,d,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.withDirectives(o.createVNode("textarea",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=o=>e.model[e.schema.model]=o)},null,8,["id"]),[[o.vModelText,e.model[e.schema.model]]])],8,["for"]))));a.render=d,a.__scopeId="data-v-54e601bc";var t=o.defineComponent({name:"FormGroup",components:{},props:{schema:{},model:{},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",__assign(__assign({},e),{groupModel:this.schema.model}))},handleChange(e){this.$emit("change-model",__assign(__assign({},e),{groupModel:this.schema.model}))},handleInput(e){this.$emit("input",__assign(__assign({},e),{groupModel:this.schema.model}))}}});const r=o.withScopeId("data-v-67a2e95e");o.pushScopeId("data-v-67a2e95e");const m={class:"form-group"};o.popScopeId();const h=r(((e,l,n,a,d,t)=>(o.openBlock(),o.createBlock("div",m,[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.localModel(),((n,a)=>(o.openBlock(),o.createBlock(o.Fragment,null,[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.items,(n=>(o.openBlock(),o.createBlock("div",{key:`group-${a}`,id:`${a}-${n.model}`},[o.createTextVNode(o.toDisplayString(n.model+n.type)+" ",1),o.renderSlot(e.$slots,"field",{id:`${e.id}-${n.model}-${a}`,model:e.localFieldModel(a),schema:n,index:a,onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChangeModel:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=(...o)=>e.handleInput&&e.handleInput(...o))})],8,["id"])))),128)),o.renderSlot(e.$slots,"button",{index:a})],64)))),256))]))));t.render=h,t.__scopeId="data-v-67a2e95e";var s=o.defineComponent({name:"FormSelect",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:n,schema:a,id:d}=o.toRefs(e),t=e=>[...e.target.options].filter((e=>e.selected)).map((e=>{return o=e,a.multipleByKey?o[a.optionValueKey||"value"]:o;var o})),r=e=>a.multiple?t(e):e.target.value,m=(e,o)=>{l.emit(e,{value:r(o),model:n,schema:a,id:d,originalEvent:o})};return{handleBlur:e=>{m("blur",e)},handleChange:e=>{m("change-model",e)},handleInput:e=>{m("input",e)}}}});const c=o.withScopeId("data-v-47025f5b")(((e,l,n,a,d,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.createVNode("select",{id:e.id,value:e.model[e.schema.model],name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple||!1,disabled:e.schema.disabled,required:e.schema.required,onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=(...o)=>e.handleInput&&e.handleInput(...o))},[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.options,(l=>(o.openBlock(),o.createBlock("option",{key:`${e.id}-${e.schema.model}-${l.value}`,value:l[e.schema.optionValueKey||"value"],selected:l.selected},o.toDisplayString(l[e.schema.optionLabelKey||"label"]),9,["value","selected"])))),128))],40,["id","value","name","size","multiple","disabled","required"])],8,["for"]))));s.render=c,s.__scopeId="data-v-47025f5b";var i=o.defineComponent({name:"FormField",components:{FormSelect:s,FormGroup:t,FormTextarea:a,FormInput:l},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blur",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("input",e)},handleInputGroupBlur(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("blur",e,o,l)},handleGroupChange(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,o,l)},handleGroupInput(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("input",e,o,l)},addGroupElement(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("add-group-element",e,o,l)}}});const u=o.withScopeId("data-v-21326d0b");o.pushScopeId("data-v-21326d0b");const p={class:"form-field"};o.popScopeId();const g=u(((e,l,n,a,d,t)=>{const r=o.resolveComponent("form-input"),m=o.resolveComponent("form-textarea"),h=o.resolveComponent("form-select"),s=o.resolveComponent("_self"),c=o.resolveComponent("form-group");return o.openBlock(),o.createBlock("div",p,["input"===e.schema.type?(o.openBlock(),o.createBlock(r,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0),"textarea"===e.schema.type?(o.openBlock(),o.createBlock(m,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0),"select"===e.schema.type?(o.openBlock(),o.createBlock(h,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},null,8,["id","model","schema","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0),"group"===e.schema.type?(o.openBlock(),o.createBlock(c,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlur:e.handleInputBlur,onChangeModel:e.handleChange,onInput:e.handleInput},{field:u((l=>[o.createVNode(s,{id:l.id,model:l.model,schema:l.schema,onBlur:o=>e.handleInputGroupBlur(o,e.schema,l),onChangeModel:o=>e.handleGroupChange(o,e.schema,l),onInput:o=>e.handleGroupInput(o,e.schema,l),onAddGroupElement:o=>e.addGroupElement(o,e.schema,l)},null,8,["id","model","schema","onBlur","onChangeModel","onInput","onAddGroupElement"])])),button:u((l=>[o.createVNode("button",{onClick:()=>e.addGroupElement({},e.schema,l)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlur","onChangeModel","onInput"])):o.createCommentVNode("",!0)])}));i.render=g,i.__scopeId="data-v-21326d0b";var B=o.defineComponent({name:"FormVuelator",components:{FormField:i},props:{model:{required:!0},schema:{required:!0}},emits:["change-model"],setup:(e,l)=>{const{model:n,schema:a,id:d}=o.toRefs(e),t=(e,o,l,n,a)=>{let d,r;[d,...o]=o,[r,...l]=l;let m={};d&&0===o.length&&(m[n]=a.value),e.hasOwnProperty(d)?e[d][r]?e[d][r]=__assign(__assign({},e[d][r]),m):Array.isArray(e[d])?e[d].push(m):e[d]=[].push(m):(e[d]=[],e[d].hasOwnProperty(r)?e[d]=[].push(m):e[d][r]=m),0!==o.length?t(e[d][r],o,l,n,a):e[d][r]=__assign(__assign({},e[d][r]),m)};return{model:n,schema:a,handleClick:()=>{console.log(JSON.parse(JSON.stringify(n.value)))},handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e)},handleInput:e=>{let o=n.value,a=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(n.value,e.schemaModelPath,e.schemaModelIndex,a,e):(o[a]=e.value,l.emit("change-model",o,e.schema.value))},handleAddGroup:e=>{console.log("add",e),e.schemaModelPath,e.schemaModelIndex},id:d}}});B.render=function(e,l,n,a,d,t){const r=o.resolveComponent("form-field");return o.openBlock(),o.createBlock(o.Fragment,null,[o.createVNode("button",{onClick:l[1]||(l[1]=o.withModifiers(((...o)=>e.handleClick&&e.handleClick(...o)),["prevent"]))}),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema,((l,n)=>(o.openBlock(),o.createBlock("div",{key:`root-field-${n}`},[o.createVNode(r,{model:e.model,schema:l,id:l.model,onBlur:e.handleBlur,onChangeModel:e.handleInput,onInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlur","onChangeModel","onInput","onAddGroupElement"])])))),128))],64)},e.FormVueLator=B,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
