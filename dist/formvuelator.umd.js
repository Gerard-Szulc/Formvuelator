var __assign=Object.assign;!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).FormVuelator={},e.Vue)}(this,(function(e,o){"use strict";var l=o.defineComponent({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:a,schema:n,id:d}=o.toRefs(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})}}}});const a=o.withScopeId("data-v-297b34ea")(((e,l,a,n,d,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.createVNode("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=o.withModifiers(((...o)=>e.handleInput&&e.handleInput(...o)),["stop"]))},null,40,["id","type","value"])],8,["for"]))));l.render=a,l.__scopeId="data-v-297b34ea";var n=o.defineComponent({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}}});const d=o.withScopeId("data-v-51051852")(((e,l,a,n,d,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.withDirectives(o.createVNode("textarea",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=o=>e.model[e.schema.model]=o)},null,8,["id"]),[[o.vModelText,e.model[e.schema.model]]])],8,["for"]))));n.render=d,n.__scopeId="data-v-51051852";var t=o.defineComponent({name:"FormGroup",components:{},props:{schema:{},model:{},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",__assign(__assign({},e),{groupModel:this.schema.model}))},handleChange(e){this.$emit("change-model",__assign(__assign({},e),{groupModel:this.schema.model}))},handleInput(e){this.$emit("input",__assign(__assign({},e),{groupModel:this.schema.model}))}}});const m=o.withScopeId("data-v-67a2e95e");o.pushScopeId("data-v-67a2e95e");const r={class:"form-group"};o.popScopeId();const s=m(((e,l,a,n,d,t)=>(o.openBlock(),o.createBlock("div",r,[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.localModel(),((a,n)=>(o.openBlock(),o.createBlock(o.Fragment,null,[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.items,(a=>(o.openBlock(),o.createBlock("div",{key:`group-${n}`,id:`${n}-${a.model}`},[o.createTextVNode(o.toDisplayString(a.model+a.type)+" ",1),o.renderSlot(e.$slots,"field",{id:`${e.id}-${a.model}-${n}`,model:e.localFieldModel(n),schema:a,index:n,onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChangeModel:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=(...o)=>e.handleInput&&e.handleInput(...o))})],8,["id"])))),128)),o.renderSlot(e.$slots,"button",{index:n})],64)))),256))]))));t.render=s,t.__scopeId="data-v-67a2e95e";var h=o.defineComponent({name:"FormSelect",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},computed:{value:{get(){return this.schema.multiple?this.schema.multipleAsObjects?(this.model[this.schema.model]||[]).map((e=>e[this.schema.optionValueKey||"value"])):this.model[this.schema.model]||[]:this.model[this.schema.model]||null},set:(e,...o)=>e}},setup(e,l){const{model:a,schema:n,id:d}=o.toRefs(e),t=e=>Array(...e).reduce(((e,o)=>(e.push((e=>{if(n.value.multipleAsObjects){let o={};return o[n.value.optionValueKey||"value"]=e.value,o[n.value.optionLabelKey||"label"]=e.label,o}return e.value})(o)),e)),[]),m=e=>n.value.multiple?t(e):e,r=(e,o,t=null)=>{l.emit(e,{value:m(o),model:a,schema:n,id:d,originalEvent:t})};return{handleBlur:e=>{r("blured",n.value.multiple?e.target.selectedOptions:e.target.value,e)},handleChange:e=>{r("change-model",n.value.multiple?e.target.selectedOptions:e.target.value,e)},emitEvent:r}}});const c=o.withScopeId("data-v-35749e0a");o.pushScopeId("data-v-35749e0a");const i={key:0,value:null};o.popScopeId();const u=c(((e,l,a,n,d,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.withDirectives(o.createVNode("select",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value=o),value:e.value,name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple,disabled:e.schema.disabled,required:e.schema.required,onBlur:l[2]||(l[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[3]||(l[3]=o.withModifiers(((...o)=>e.handleChange&&e.handleChange(...o)),["stop"]))},[e.schema.multiple?o.createCommentVNode("",!0):(o.openBlock(),o.createBlock("option",i,o.toDisplayString(e.schema.nothingSelectedLabel||"Nothing selected"),1)),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.options,((l,a)=>(o.openBlock(),o.createBlock("option",{key:`${e.id}-${e.schema.model}-${l[e.schema.optionValueKey||"value"]}-temp`,value:l[e.schema.optionValueKey||"value"]},o.toDisplayString(l[e.schema.optionLabelKey||"label"]),9,["value"])))),128))],40,["id","value","name","size","multiple","disabled","required"]),[[o.vModelSelect,e.value]])],8,["for"]))));h.render=u,h.__scopeId="data-v-35749e0a";var p=o.defineComponent({name:"FormField",components:{FormSelect:h,FormGroup:t,FormTextarea:n,FormInput:l},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blured",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("form-input",e)},handleInputGroupBlur(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("blured",e,o,l)},handleGroupChange(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,o,l)},handleGroupInput(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("form-input",e,o,l)},addGroupElement(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("add-group-element",e,o,l)}}});const g=o.withScopeId("data-v-25e59210");o.pushScopeId("data-v-25e59210");const v={class:"form-field"};o.popScopeId();const B=g(((e,l,a,n,d,t)=>{const m=o.resolveComponent("form-input"),r=o.resolveComponent("form-textarea"),s=o.resolveComponent("form-select"),h=o.resolveComponent("_self"),c=o.resolveComponent("form-group");return o.openBlock(),o.createBlock("div",v,["input"===e.schema.type?(o.openBlock(),o.createBlock(m,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):o.createCommentVNode("",!0),"textarea"===e.schema.type?(o.openBlock(),o.createBlock(r,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):o.createCommentVNode("",!0),"select"===e.schema.type?(o.openBlock(),o.createBlock(s,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange},null,8,["id","model","schema","onBlured","onChangeModel"])):o.createCommentVNode("",!0),"group"===e.schema.type?(o.openBlock(),o.createBlock(c,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},{field:g((l=>[o.createVNode(h,{id:l.id,model:l.model,schema:l.schema,onBlured:o=>e.handleInputGroupBlur(o,e.schema,l),onChangeModel:o=>e.handleGroupChange(o,e.schema,l),onFormInput:o=>e.handleGroupInput(o,e.schema,l),onAddGroupElement:o=>e.addGroupElement(o,e.schema,l)},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])),button:g((l=>[o.createVNode("button",{onClick:()=>e.addGroupElement({},e.schema,l)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlured","onChangeModel","onFormInput"])):o.createCommentVNode("",!0)])}));p.render=B,p.__scopeId="data-v-25e59210";var I=o.defineComponent({name:"FormVuelator",components:{FormField:p},props:{model:{required:!0},schema:{required:!0}},emits:["change-model"],setup:(e,l)=>{const{model:a,schema:n,id:d}=o.toRefs(e),t=(e,o,l,a,n)=>{let d,m;[d,...o]=o,[m,...l]=l;let r={};d&&0===o.length&&(r[a]=n.value),e.hasOwnProperty(d)?e[d][m]?e[d][m]=__assign(__assign({},e[d][m]),r):Array.isArray(e[d])?e[d].push(r):e[d]=[].push(r):(e[d]=[],e[d].hasOwnProperty(m)?e[d]=[].push(r):e[d][m]=r),0!==o.length?t(e[d][m],o,l,a,n):e[d][m]=__assign(__assign({},e[d][m]),r)};return{model:a,schema:n,handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e);let o=a.value,n=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(a.value,e.schemaModelPath,e.schemaModelIndex,n,e):(o[n]=e.value,l.emit("change-model",o,e.schema.value))},handleInput:e=>{console.log(e);let o=a.value,n=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(a.value,e.schemaModelPath,e.schemaModelIndex,n,e):(console.log(e.value),o[n]=e.value,l.emit("change-model",o,e.schema.value))},handleAddGroup:e=>{console.log("add",e),e.schemaModelPath,e.schemaModelIndex},id:d}}});I.render=function(e,l,a,n,d,t){const m=o.resolveComponent("form-field");return o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema,((l,a)=>(o.openBlock(),o.createBlock("div",{key:`root-field-${a}`},[o.createVNode(m,{model:e.model,schema:l,id:l.model,onBlured:e.handleBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput,onAddGroupElement:o.withModifiers(e.handleAddGroup,["stop"])},null,8,["model","schema","id","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])))),128)},e.FormVuelator=I,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
