(function(B,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],l):(B=typeof globalThis<"u"?globalThis:B||self,l(B.FormVuelator={},B.Vue))})(this,function(B,l){"use strict";const I=l.defineComponent({name:"FormInput",props:{model:{type:Object,default:()=>({}),required:!0},schema:{type:Object,default:()=>({}),required:!0},id:{type:String,required:!0}},setup(e,o){const{model:t,schema:s,id:i}=l.toRefs(e);return{handleBlur:m=>{o.emit("blured",{value:m.target.value,model:t,schema:s,id:i,originalEvent:m})},handleChange:m=>{o.emit("change-model",{value:m.target.value,model:t,schema:s,id:i,originalEvent:m})},handleInput:m=>{o.emit("form-input",{value:m.target.value,model:t,schema:s,id:i,originalEvent:m})}}}}),C=(e,o)=>{const t=e.__vccOpts||e;for(const[s,i]of o)t[s]=i;return t},k=["for"],b=["id","type","value"];function E(e,o,t,s,i,u){return l.openBlock(),l.createElementBlock("div",{class:l.normalizeClass(e.schema.classes&&e.schema.classes.fieldContainer||"")},[l.createElementVNode("label",{for:e.id,class:l.normalizeClass(e.schema.classes&&e.schema.classes.label||"")},l.toDisplayString(e.schema.label||""),11,k),l.createElementVNode("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:o[0]||(o[0]=(...d)=>e.handleBlur&&e.handleBlur(...d)),onChange:o[1]||(o[1]=(...d)=>e.handleChange&&e.handleChange(...d)),onInput:o[2]||(o[2]=l.withModifiers((...d)=>e.handleInput&&e.handleInput(...d),["stop"])),class:l.normalizeClass(e.schema.classes&&e.schema.classes.field||"")},null,42,b)],2)}const F=C(I,[["render",E]]),M=l.defineComponent({name:"FormTextarea",props:{model:{required:!0,type:Object},schema:{required:!0,type:Object},id:{type:String,required:!0}},setup(e,o){const{model:t,schema:s,id:i}=l.toRefs(e);return{handleBlur:m=>{o.emit("blured",{value:m.target.value,model:t,schema:s,id:i,originalEvent:m})},handleChange:m=>{o.emit("change-model",{value:m.target.value,model:t,schema:s,id:i,originalEvent:m})},handleInput:m=>{o.emit("form-input",{value:m.target.value,model:t,schema:s,id:i,originalEvent:m})}}}}),V=["for"],O=["id","value"];function G(e,o,t,s,i,u){return l.openBlock(),l.createElementBlock("div",{class:l.normalizeClass(e.schema.classes&&e.schema.classes.fieldContainer||"")},[l.createElementVNode("label",{for:e.id,class:l.normalizeClass(e.schema.classes&&e.schema.classes.label||"")},l.toDisplayString(e.schema.label||""),11,V),l.createElementVNode("textarea",{id:e.id,value:e.model[e.schema.model],onBlur:o[0]||(o[0]=(...d)=>e.handleBlur&&e.handleBlur(...d)),onChange:o[1]||(o[1]=(...d)=>e.handleChange&&e.handleChange(...d)),onInput:o[2]||(o[2]=l.withModifiers((...d)=>e.handleInput&&e.handleInput(...d),["stop"])),class:l.normalizeClass(e.schema.classes&&e.schema.classes.field||"")},null,42,O)],2)}const q=C(M,[["render",G]]),j=l.defineComponent({name:"FormGroup",components:{},props:{schema:{type:Object,default:()=>({})},model:{type:Object,default:()=>({})},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model].length!==0?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",{...e,groupModel:this.schema.model})},handleChange(e){this.$emit("change-model",{...e,groupModel:this.schema.model})},handleInput(e){this.$emit("input",{...e,groupModel:this.schema.model})}}}),v="",N={class:"form-group"},S=["id"];function w(e,o,t,s,i,u){return l.openBlock(),l.createElementBlock("div",N,[l.createTextVNode(l.toDisplayString(e.schema.label||"")+" ",1),(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.localModel(),(d,p)=>(l.openBlock(),l.createElementBlock(l.Fragment,null,[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.schema.items,m=>(l.openBlock(),l.createElementBlock("div",{key:`group-${p}`,id:`${p}-${m.model}`},[l.renderSlot(e.$slots,"field",{id:`${e.id}-${m.model}-${p}`,model:e.localFieldModel(p),schema:m,index:p,onBlur:o[0]||(o[0]=(...g)=>e.handleBlur&&e.handleBlur(...g)),onChangeModel:o[1]||(o[1]=(...g)=>e.handleChange&&e.handleChange(...g)),onInput:o[2]||(o[2]=(...g)=>e.handleInput&&e.handleInput(...g))},void 0,!0)],8,S))),128)),l.renderSlot(e.$slots,"button",{index:p},void 0,!0)],64))),256))])}const A=C(j,[["render",w],["__scopeId","data-v-589a6f6e"]]),P=l.defineComponent({name:"FormSelect",props:{model:{type:Object,default:()=>({}),required:!0},schema:{type:Object,default:()=>({}),required:!0},id:{type:String,required:!0}},computed:{value:{get(){return this.schema.multiple?this.schema.multipleAsObjects?(this.model[this.schema.model]||[]).map(e=>e[this.schema.optionValueKey||"value"]):this.model[this.schema.model]||[]:this.model[this.schema.model]||""},set(e,...o){return e}}},setup(e,o){const{model:t,schema:s,id:i}=l.toRefs(e),u=a=>{if(s.value.multipleAsObjects){let r={};return r[s.value.optionValueKey||"value"]=a.value,r[s.value.optionLabelKey||"label"]=a.label,r}return a.value},d=a=>Array(...a).reduce((r,$)=>(r.push(u($)),r),[]),p=a=>s.value.multiple?d(a):a,m=(a,r,$=null)=>{o.emit(a,{value:p(r),model:t,schema:s,id:i,originalEvent:$})};return{handleBlur:a=>{m("blured",s.value.multiple?a.target.selectedOptions:a.target.value,a)},handleChange:a=>{console.log("eeee",a.target.selectedOptions),m("change-model",s.value.multiple?a.target.selectedOptions:a.target.value,a)},emitEvent:m}}}),z=["for"],D=["id","value","name","size","multiple","disabled","required"],K={key:0,value:""},L=["value","selected"];function T(e,o,t,s,i,u){return l.openBlock(),l.createElementBlock("label",{for:e.id},[l.createTextVNode(l.toDisplayString(e.schema.label||"")+" ",1),l.createElementVNode("select",{id:e.id,value:e.value,name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple,disabled:e.schema.disabled,required:e.schema.required,onBlur:o[0]||(o[0]=(...d)=>e.handleBlur&&e.handleBlur(...d)),onChange:o[1]||(o[1]=l.withModifiers((...d)=>e.handleChange&&e.handleChange(...d),["stop"]))},[e.schema.multiple?l.createCommentVNode("",!0):(l.openBlock(),l.createElementBlock("option",K,l.toDisplayString(e.schema.nothingSelectedLabel||"Nothing selected"),1)),(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.schema.options,d=>(l.openBlock(),l.createElementBlock("option",{key:`${e.id}-${e.schema.model}-${d[e.schema.optionValueKey||"value"]}-temp`,value:d[e.schema.optionValueKey||"value"],selected:e.schema.multiple?e.value.includes(String(d[e.schema.optionValueKey||"value"])):e.value===d[e.schema.optionValueKey||"value"]},l.toDisplayString(d[e.schema.optionLabelKey||"label"]),9,L))),128))],40,D)],8,z)}const R=C(P,[["render",T]]),H=l.defineComponent({name:"FormField",components:{FormSelect:R,FormGroup:A,FormTextarea:q,FormInput:F},props:{model:{required:!0,type:Object},schema:{required:!0,type:Object},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blured",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("form-input",e)},handleInputGroupBlur(e,o,t){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[t.index,...e.schemaModelIndex||[]],this.$emit("blured",e,o,t)},handleGroupChange(e,o,t){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[t.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,o,t)},handleGroupInput(e,o,t){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[t.index,...e.schemaModelIndex||[]],this.$emit("form-input",e,o,t)},addGroupElement(e,o,t){let s={};s.schemaModelPath=[o.model,...s.schemaModelPath||[]],s.schemaModelIndex=[t.index,...s.schemaModelIndex||[]],this.$emit("add-group-element",{customEvent:s,groupSchema:o,slotProps:t})}}}),J={class:"form-field"},Q=["onClick"];function U(e,o,t,s,i,u){const d=l.resolveComponent("form-input"),p=l.resolveComponent("form-textarea"),m=l.resolveComponent("form-select"),g=l.resolveComponent("form-field",!0),n=l.resolveComponent("form-group");return l.openBlock(),l.createElementBlock("div",J,[e.schema.type==="input"?(l.openBlock(),l.createBlock(d,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):l.createCommentVNode("",!0),e.schema.type==="textarea"?(l.openBlock(),l.createBlock(p,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):l.createCommentVNode("",!0),e.schema.type==="select"?(l.openBlock(),l.createBlock(m,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange},null,8,["id","model","schema","onBlured","onChangeModel"])):l.createCommentVNode("",!0),e.schema.type==="group"?(l.openBlock(),l.createBlock(n,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},{field:l.withCtx(a=>[l.createVNode(g,{id:a.id,model:a.model,schema:a.schema,onBlured:r=>e.handleInputGroupBlur(r,e.schema,a),onChangeModel:r=>e.handleGroupChange(r,e.schema,a),onFormInput:r=>e.handleGroupInput(r,e.schema,a),onAddGroupElement:r=>e.addGroupElement(r,e.schema,a)},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput","onAddGroupElement"])]),button:l.withCtx(a=>[l.createElementVNode("button",{onClick:r=>e.addGroupElement(r,e.schema,a)},"add",8,Q)]),_:1},8,["model","schema","id","onBlured","onChangeModel","onFormInput"])):l.createCommentVNode("",!0)])}const W=C(H,[["render",U]]),X=l.defineComponent({name:"FormVuelator",components:{FormField:W},props:{model:{required:!0,type:Object},schema:{type:Array,required:!0},id:{}},emits:["change-model","model-created-property","model-created-index"],setup:(e,o)=>{const{model:t,schema:s,id:i}=l.toRefs(e),u=(n,a,r,$,y)=>{let h,c;[h,...a]=a,[c,...r]=r;let f={};if(h&&a.length===0&&(f[$]=y.value),console.log("trpp",f,n,a,r,$,y),n.hasOwnProperty(h)?n[h][c]?n[h][c]={...n[h][c],...f}:(Array.isArray(n[h])?n[h].push(f):(n[h]=[],n[h]=n[h].push(f)),o.emit("model-created-index",{currentModel:n,pathElement:h,indexElement:c,schema:y.schema.value}),console.log("trollo1")):(n[h]=[],n[h].hasOwnProperty(c)?(n[h]=[],n[h]=n[h].push(f),o.emit("model-created-property",{currentModel:n,pathElement:h,indexElement:c,schema:y.schema.value}),console.log("trollo2")):n[h][c]=f),a.length===0){n[h][c]={...n[h][c],...f};return}u(n[h][c],a,r,$,y)};return{model:t,schema:s,handleBlur:n=>{console.log("blur",n)},handleChange:n=>{console.log("change",n);let a=t.value,r=n.schema.value.model;if(n.hasOwnProperty("schemaModelPath")&&n.hasOwnProperty("schemaModelIndex")){u(t.value,n.schemaModelPath,n.schemaModelIndex,r,n);return}a[r]=n.value,o.emit("change-model",a,n.schema.value)},handleInput:n=>{console.log(n);let a=t.value,r=n.schema.value.model;if(n.hasOwnProperty("schemaModelPath")&&n.hasOwnProperty("schemaModelIndex")){u(t.value,n.schemaModelPath,n.schemaModelIndex,r,n);return}console.log(n.value),a[r]=n.value,o.emit("change-model",a,n.schema.value)},handleAddGroup:n=>{console.log("add",n),n.customEvent.schemaModelPath,n.customEvent.schemaModelIndex},id:i}}}),_="";function Y(e,o,t,s,i,u){const d=l.resolveComponent("form-field");return l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.schema,(p,m)=>(l.openBlock(),l.createElementBlock("div",{key:`root-field-${m}`},[l.createVNode(d,{model:e.model,schema:p,id:p.model,onBlured:e.handleBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlured","onChangeModel","onFormInput","onAddGroupElement"])]))),128)}const Z=C(X,[["render",Y]]);B.FormVuelator=Z,Object.defineProperties(B,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
