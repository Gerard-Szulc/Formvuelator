var __assign=Object.assign;!function(e,l){"object"==typeof exports&&"undefined"!=typeof module?l(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],l):l((e="undefined"!=typeof globalThis?globalThis:e||self).FormVuelator={},e.Vue)}(this,(function(e,l){"use strict";var o=l.defineComponent({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,o){const{model:a,schema:n,id:d}=l.toRefs(e);return{handleBlur:e=>{o.emit("blured",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})},handleChange:e=>{o.emit("change-model",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})},handleInput:e=>{o.emit("form-input",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})}}}});const a=l.withScopeId("data-v-24a7c550")(((e,o,a,n,d,t)=>(l.openBlock(),l.createBlock("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[l.createVNode("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},l.toDisplayString(e.schema.label||""),11,["for"]),l.createVNode("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:o[1]||(o[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:o[2]||(o[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:o[3]||(o[3]=l.withModifiers(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","type","value"])],2))));o.render=a,o.__scopeId="data-v-24a7c550";var n=l.defineComponent({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,o){const{model:a,schema:n,id:d}=l.toRefs(e);return{handleBlur:e=>{o.emit("blured",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})},handleChange:e=>{o.emit("change-model",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})},handleInput:e=>{o.emit("form-input",{value:e.target.value,model:a,schema:n,id:d,originalEvent:e})}}}});const d=l.withScopeId("data-v-e1e63c32")(((e,o,a,n,d,t)=>(l.openBlock(),l.createBlock("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[l.createVNode("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},l.toDisplayString(e.schema.label||""),11,["for"]),l.createVNode("textarea",{id:e.id,value:e.model[e.schema.model],onBlur:o[1]||(o[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:o[2]||(o[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:o[3]||(o[3]=l.withModifiers(((...l)=>e.handleInput&&e.handleInput(...l)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","value"])],2))));n.render=d,n.__scopeId="data-v-e1e63c32";var t=l.defineComponent({name:"FormGroup",components:{},props:{schema:{},model:{},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",__assign(__assign({},e),{groupModel:this.schema.model}))},handleChange(e){this.$emit("change-model",__assign(__assign({},e),{groupModel:this.schema.model}))},handleInput(e){this.$emit("input",__assign(__assign({},e),{groupModel:this.schema.model}))}}});const s=l.withScopeId("data-v-6706e92e");l.pushScopeId("data-v-6706e92e");const m={class:"form-group"};l.popScopeId();const r=s(((e,o,a,n,d,t)=>(l.openBlock(),l.createBlock("div",m,[l.createTextVNode(l.toDisplayString(e.schema.label||"")+" ",1),(l.openBlock(!0),l.createBlock(l.Fragment,null,l.renderList(e.localModel(),((a,n)=>(l.openBlock(),l.createBlock(l.Fragment,null,[(l.openBlock(!0),l.createBlock(l.Fragment,null,l.renderList(e.schema.items,(a=>(l.openBlock(),l.createBlock("div",{key:`group-${n}`,id:`${n}-${a.model}`},[l.renderSlot(e.$slots,"field",{id:`${e.id}-${a.model}-${n}`,model:e.localFieldModel(n),schema:a,index:n,onBlur:o[1]||(o[1]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChangeModel:o[2]||(o[2]=(...l)=>e.handleChange&&e.handleChange(...l)),onInput:o[3]||(o[3]=(...l)=>e.handleInput&&e.handleInput(...l))})],8,["id"])))),128)),l.renderSlot(e.$slots,"button",{index:n})],64)))),256))]))));t.render=r,t.__scopeId="data-v-6706e92e";var c=l.defineComponent({name:"FormSelect",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},computed:{value:{get(){return this.schema.multiple?this.schema.multipleAsObjects?(this.model[this.schema.model]||[]).map((e=>e[this.schema.optionValueKey||"value"])):this.model[this.schema.model]||[]:this.model[this.schema.model]||null},set:(e,...l)=>e}},setup(e,o){const{model:a,schema:n,id:d}=l.toRefs(e),t=e=>Array(...e).reduce(((e,l)=>(e.push((e=>{if(n.value.multipleAsObjects){let l={};return l[n.value.optionValueKey||"value"]=e.value,l[n.value.optionLabelKey||"label"]=e.label,l}return e.value})(l)),e)),[]),s=e=>n.value.multiple?t(e):e,m=(e,l,t=null)=>{o.emit(e,{value:s(l),model:a,schema:n,id:d,originalEvent:t})};return{handleBlur:e=>{m("blured",n.value.multiple?e.target.selectedOptions:e.target.value,e)},handleChange:e=>{m("change-model",n.value.multiple?e.target.selectedOptions:e.target.value,e)},emitEvent:m}}});const h=l.withScopeId("data-v-e700cc5c");l.pushScopeId("data-v-e700cc5c");const i={key:0,value:null};l.popScopeId();const u=h(((e,o,a,n,d,t)=>(l.openBlock(),l.createBlock("label",{for:e.id},[l.createTextVNode(l.toDisplayString(e.schema.label||"")+" ",1),l.withDirectives(l.createVNode("select",{id:e.id,"onUpdate:modelValue":o[1]||(o[1]=l=>e.value=l),value:e.value,name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple,disabled:e.schema.disabled,required:e.schema.required,onBlur:o[2]||(o[2]=(...l)=>e.handleBlur&&e.handleBlur(...l)),onChange:o[3]||(o[3]=l.withModifiers(((...l)=>e.handleChange&&e.handleChange(...l)),["stop"]))},[e.schema.multiple?l.createCommentVNode("",!0):(l.openBlock(),l.createBlock("option",i,l.toDisplayString(e.schema.nothingSelectedLabel||"Nothing selected"),1)),(l.openBlock(!0),l.createBlock(l.Fragment,null,l.renderList(e.schema.options,((o,a)=>(l.openBlock(),l.createBlock("option",{key:`${e.id}-${e.schema.model}-${o[e.schema.optionValueKey||"value"]}-temp`,value:o[e.schema.optionValueKey||"value"]},l.toDisplayString(o[e.schema.optionLabelKey||"label"]),9,["value"])))),128))],40,["id","value","name","size","multiple","disabled","required"]),[[l.vModelSelect,e.value]])],8,["for"]))));c.render=u,c.__scopeId="data-v-e700cc5c";var p=l.defineComponent({name:"FormField",components:{FormSelect:c,FormGroup:t,FormTextarea:n,FormInput:o},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blured",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("form-input",e)},handleInputGroupBlur(e,l,o){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[o.index,...e.schemaModelIndex||[]],this.$emit("blured",e,l,o)},handleGroupChange(e,l,o){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[o.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,l,o)},handleGroupInput(e,l,o){e.schemaModelPath=[l.model,...e.schemaModelPath||[]],e.schemaModelIndex=[o.index,...e.schemaModelIndex||[]],this.$emit("form-input",e,l,o)},addGroupElement(e,l,o){let a={};a.schemaModelPath=[l.model,...a.schemaModelPath||[]],a.schemaModelIndex=[o.index,...a.schemaModelIndex||[]],this.$emit("add-group-element",{customEvent:a,groupSchema:l,slotProps:o})}}});const g=l.withScopeId("data-v-c4fba7d4");l.pushScopeId("data-v-c4fba7d4");const v={class:"form-field"};l.popScopeId();const B=g(((e,o,a,n,d,t)=>{const s=l.resolveComponent("form-input"),m=l.resolveComponent("form-textarea"),r=l.resolveComponent("form-select"),c=l.resolveComponent("_self"),h=l.resolveComponent("form-group");return l.openBlock(),l.createBlock("div",v,["input"===e.schema.type?(l.openBlock(),l.createBlock(s,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):l.createCommentVNode("",!0),"textarea"===e.schema.type?(l.openBlock(),l.createBlock(m,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):l.createCommentVNode("",!0),"select"===e.schema.type?(l.openBlock(),l.createBlock(r,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange},null,8,["id","model","schema","onBlured","onChangeModel"])):l.createCommentVNode("",!0),"group"===e.schema.type?(l.openBlock(),l.createBlock(h,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},{field:g((o=>[l.createVNode(c,{id:o.id,model:o.model,schema:o.schema,onBlured:l=>e.handleInputGroupBlur(l,e.schema,o),onChangeModel:l=>e.handleGroupChange(l,e.schema,o),onFormInput:l=>e.handleGroupInput(l,e.schema,o),onAddGroupElement:l=>e.addGroupElement(l,e.schema,o)},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])),button:g((o=>[l.createVNode("button",{onClick:l=>e.addGroupElement(l,e.schema,o)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlured","onChangeModel","onFormInput"])):l.createCommentVNode("",!0)])}));p.render=B,p.__scopeId="data-v-c4fba7d4";var I=l.defineComponent({name:"FormVuelator",components:{FormField:p},props:{model:{type:Object,required:!0},schema:{type:Array,required:!0},id:{}},emits:["change-model","model-created-property","model-created-index"],setup:(e,o)=>{const{model:a,schema:n,id:d}=l.toRefs(e),t=(e,l,a,n,d)=>{let s,m;[s,...l]=l,[m,...a]=a;let r={};s&&0===l.length&&(r[n]=d.value),console.log("trpp",r,e,l,a,n,d),e.hasOwnProperty(s)?e[s][m]?e[s][m]=__assign(__assign({},e[s][m]),r):(Array.isArray(e[s])?e[s].push(r):e[s]=[].push(r),o.emit("model-created-index",{currentModel:e,pathElement:s,indexElement:m,schema:d.schema.value}),console.log("trollo1")):(e[s]=[],e[s].hasOwnProperty(m)?(e[s]=[].push(r),o.emit("model-created-property",{currentModel:e,pathElement:s,indexElement:m,schema:d.schema.value}),console.log("trollo2")):e[s][m]=r),0!==l.length?t(e[s][m],l,a,n,d):e[s][m]=__assign(__assign({},e[s][m]),r)};return{model:a,schema:n,handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e);let l=a.value,n=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(a.value,e.schemaModelPath,e.schemaModelIndex,n,e):(l[n]=e.value,o.emit("change-model",l,e.schema.value))},handleInput:e=>{console.log(e);let l=a.value,n=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(a.value,e.schemaModelPath,e.schemaModelIndex,n,e):(console.log(e.value),l[n]=e.value,o.emit("change-model",l,e.schema.value))},handleAddGroup:e=>{console.log("add",e),e.customEvent.schemaModelPath,e.customEvent.schemaModelIndex},id:d}}});I.render=function(e,o,a,n,d,t){const s=l.resolveComponent("form-field");return l.openBlock(!0),l.createBlock(l.Fragment,null,l.renderList(e.schema,((o,a)=>(l.openBlock(),l.createBlock("div",{key:`root-field-${a}`},[l.createVNode(s,{model:e.model,schema:o,id:o.model,onBlured:e.handleBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])))),128)},e.FormVuelator=I,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
