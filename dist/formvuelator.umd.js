var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,o,l)=>o in e?__defProp(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,__spreadValues=(e,o)=>{for(var l in o||(o={}))__hasOwnProp.call(o,l)&&__defNormalProp(e,l,o[l]);if(__getOwnPropSymbols)for(var l of __getOwnPropSymbols(o))__propIsEnum.call(o,l)&&__defNormalProp(e,l,o[l]);return e},__spreadProps=(e,o)=>__defProps(e,__getOwnPropDescs(o));!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).FormVuelator={},e.Vue)}(this,(function(e,o){"use strict";var l=o.defineComponent({name:"FormInput",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:a,schema:d,id:n}=o.toRefs(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:a,schema:d,id:n,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:a,schema:d,id:n,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:a,schema:d,id:n,originalEvent:e})}}}});const a=o.withScopeId("data-v-ce4071b4")(((e,l,a,d,n,t)=>(o.openBlock(),o.createBlock("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[o.createVNode("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},o.toDisplayString(e.schema.label||""),11,["for"]),o.createVNode("input",{id:e.id,type:e.schema.subtype||"text",value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=o.withModifiers(((...o)=>e.handleInput&&e.handleInput(...o)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","type","value"])],2))));l.render=a,l.__scopeId="data-v-ce4071b4";var d=o.defineComponent({name:"FormTextarea",props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},setup(e,l){const{model:a,schema:d,id:n}=o.toRefs(e);return{handleBlur:e=>{l.emit("blured",{value:e.target.value,model:a,schema:d,id:n,originalEvent:e})},handleChange:e=>{l.emit("change-model",{value:e.target.value,model:a,schema:d,id:n,originalEvent:e})},handleInput:e=>{l.emit("form-input",{value:e.target.value,model:a,schema:d,id:n,originalEvent:e})}}}});const n=o.withScopeId("data-v-3c6bf935")(((e,l,a,d,n,t)=>(o.openBlock(),o.createBlock("div",{class:e.schema.classes&&e.schema.classes.fieldContainer||""},[o.createVNode("label",{for:e.id,class:e.schema.classes&&e.schema.classes.label||""},o.toDisplayString(e.schema.label||""),11,["for"]),o.createVNode("textarea",{id:e.id,value:e.model[e.schema.model],onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=o.withModifiers(((...o)=>e.handleInput&&e.handleInput(...o)),["stop"])),class:e.schema.classes&&e.schema.classes.field||""},null,42,["id","value"])],2))));d.render=n,d.__scopeId="data-v-3c6bf935";var t=o.defineComponent({name:"FormGroup",components:{},props:{schema:{type:Object,default:()=>({})},model:{type:Object,default:()=>({})},id:{}},computed:{},methods:{localFieldModel(e){return this.model.hasOwnProperty(this.schema.model)&&this.model[this.schema.model][e]||{}},localModel(){return this.model.hasOwnProperty(this.schema.model)&&0!==this.model[this.schema.model].length?this.model[this.schema.model]:[{}]},handleBlur(e){this.$emit("blur",__spreadProps(__spreadValues({},e),{groupModel:this.schema.model}))},handleChange(e){this.$emit("change-model",__spreadProps(__spreadValues({},e),{groupModel:this.schema.model}))},handleInput(e){this.$emit("input",__spreadProps(__spreadValues({},e),{groupModel:this.schema.model}))}}});const r=o.withScopeId("data-v-828ccd04");o.pushScopeId("data-v-828ccd04");const s={class:"form-group"};o.popScopeId();const m=r(((e,l,a,d,n,t)=>(o.openBlock(),o.createBlock("div",s,[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.localModel(),((a,d)=>(o.openBlock(),o.createBlock(o.Fragment,null,[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.items,(a=>(o.openBlock(),o.createBlock("div",{key:`group-${d}`,id:`${d}-${a.model}`},[o.renderSlot(e.$slots,"field",{id:`${e.id}-${a.model}-${d}`,model:e.localFieldModel(d),schema:a,index:d,onBlur:l[1]||(l[1]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChangeModel:l[2]||(l[2]=(...o)=>e.handleChange&&e.handleChange(...o)),onInput:l[3]||(l[3]=(...o)=>e.handleInput&&e.handleInput(...o))},void 0,!0)],8,["id"])))),128)),o.renderSlot(e.$slots,"button",{index:d},void 0,!0)],64)))),256))]))));t.render=m,t.__scopeId="data-v-828ccd04";var c=o.defineComponent({name:"FormSelect",props:{model:{type:Object,default:()=>({}),required:!0},schema:{type:Object,default:()=>({}),required:!0},id:{type:String,required:!0}},computed:{value:{get(){return this.schema.multiple?this.schema.multipleAsObjects?(this.model[this.schema.model]||[]).map((e=>e[this.schema.optionValueKey||"value"])):this.model[this.schema.model]||[]:this.model[this.schema.model]||null},set:(e,...o)=>e}},setup(e,l){const{model:a,schema:d,id:n}=o.toRefs(e),t=e=>Array(...e).reduce(((e,o)=>(e.push((e=>{if(d.value.multipleAsObjects){let o={};return o[d.value.optionValueKey||"value"]=e.value,o[d.value.optionLabelKey||"label"]=e.label,o}return e.value})(o)),e)),[]),r=e=>d.value.multiple?t(e):e,s=(e,o,t=null)=>{l.emit(e,{value:r(o),model:a,schema:d,id:n,originalEvent:t})};return{handleBlur:e=>{s("blured",d.value.multiple?e.target.selectedOptions:e.target.value,e)},handleChange:e=>{s("change-model",d.value.multiple?e.target.selectedOptions:e.target.value,e)},emitEvent:s}}});const h=o.withScopeId("data-v-e7021456");o.pushScopeId("data-v-e7021456");const u={key:0,value:null};o.popScopeId();const i=h(((e,l,a,d,n,t)=>(o.openBlock(),o.createBlock("label",{for:e.id},[o.createTextVNode(o.toDisplayString(e.schema.label||"")+" ",1),o.withDirectives(o.createVNode("select",{id:e.id,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value=o),value:e.value,name:e.schema.name,size:e.schema.size,multiple:e.schema.multiple,disabled:e.schema.disabled,required:e.schema.required,onBlur:l[2]||(l[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onChange:l[3]||(l[3]=o.withModifiers(((...o)=>e.handleChange&&e.handleChange(...o)),["stop"]))},[e.schema.multiple?o.createCommentVNode("",!0):(o.openBlock(),o.createBlock("option",u,o.toDisplayString(e.schema.nothingSelectedLabel||"Nothing selected"),1)),(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema.options,((l,a)=>(o.openBlock(),o.createBlock("option",{key:`${e.id}-${e.schema.model}-${l[e.schema.optionValueKey||"value"]}-temp`,value:l[e.schema.optionValueKey||"value"]},o.toDisplayString(l[e.schema.optionLabelKey||"label"]),9,["value"])))),128))],40,["id","value","name","size","multiple","disabled","required"]),[[o.vModelSelect,e.value]])],8,["for"]))));c.render=i,c.__scopeId="data-v-e7021456";var p=o.defineComponent({name:"FormField",components:{FormSelect:c,FormGroup:t,FormTextarea:d,FormInput:l},props:{model:{required:!0},schema:{required:!0},id:{type:String,required:!0}},mounted(){},methods:{handleInputBlur(e){this.$emit("blured",e)},handleChange(e){this.$emit("change-model",e)},handleInput(e){this.$emit("form-input",e)},handleInputGroupBlur(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("blured",e,o,l)},handleGroupChange(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("change-model",e,o,l)},handleGroupInput(e,o,l){e.schemaModelPath=[o.model,...e.schemaModelPath||[]],e.schemaModelIndex=[l.index,...e.schemaModelIndex||[]],this.$emit("form-input",e,o,l)},addGroupElement(e,o,l){let a={};a.schemaModelPath=[o.model,...a.schemaModelPath||[]],a.schemaModelIndex=[l.index,...a.schemaModelIndex||[]],this.$emit("add-group-element",{customEvent:a,groupSchema:o,slotProps:l})}}});const g=o.withScopeId("data-v-d60fc254");o.pushScopeId("data-v-d60fc254");const v={class:"form-field"};o.popScopeId();const f=g(((e,l,a,d,n,t)=>{const r=o.resolveComponent("form-input"),s=o.resolveComponent("form-textarea"),m=o.resolveComponent("form-select"),c=o.resolveComponent("form-field",!0),h=o.resolveComponent("form-group");return o.openBlock(),o.createBlock("div",v,["input"===e.schema.type?(o.openBlock(),o.createBlock(r,{key:0,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):o.createCommentVNode("",!0),"textarea"===e.schema.type?(o.openBlock(),o.createBlock(s,{key:1,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput"])):o.createCommentVNode("",!0),"select"===e.schema.type?(o.openBlock(),o.createBlock(m,{key:2,id:`${e.id}-${e.schema.model}`,model:e.model,schema:e.schema,onBlured:e.handleInputBlur,onChangeModel:e.handleChange},null,8,["id","model","schema","onBlured","onChangeModel"])):o.createCommentVNode("",!0),"group"===e.schema.type?(o.openBlock(),o.createBlock(h,{key:3,model:e.model,schema:e.schema,id:`${e.id}-${e.schema.model}`,onBlured:e.handleInputBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput},{field:g((l=>[o.createVNode(c,{id:l.id,model:l.model,schema:l.schema,onBlured:o=>e.handleInputGroupBlur(o,e.schema,l),onChangeModel:o=>e.handleGroupChange(o,e.schema,l),onFormInput:o=>e.handleGroupInput(o,e.schema,l),onAddGroupElement:o=>e.addGroupElement(o,e.schema,l)},null,8,["id","model","schema","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])),button:g((l=>[o.createVNode("button",{onClick:o=>e.addGroupElement(o,e.schema,l)},"add",8,["onClick"])])),_:1},8,["model","schema","id","onBlured","onChangeModel","onFormInput"])):o.createCommentVNode("",!0)])}));p.render=f,p.__scopeId="data-v-d60fc254";var B=o.defineComponent({name:"FormVuelator",components:{FormField:p},props:{model:{type:Object,required:!0},schema:{type:Array,required:!0},id:{}},emits:["change-model","model-created-property","model-created-index"],setup:(e,l)=>{const{model:a,schema:d,id:n}=o.toRefs(e),t=(e,o,a,d,n)=>{let r,s;[r,...o]=o,[s,...a]=a;let m={};r&&0===o.length&&(m[d]=n.value),console.log("trpp",m,e,o,a,d,n),e.hasOwnProperty(r)?e[r][s]?e[r][s]=__spreadValues(__spreadValues({},e[r][s]),m):(Array.isArray(e[r])?e[r].push(m):(e[r]=[],e[r]=e[r].push(m)),l.emit("model-created-index",{currentModel:e,pathElement:r,indexElement:s,schema:n.schema.value}),console.log("trollo1")):(e[r]=[],e[r].hasOwnProperty(s)?(e[r]=[],e[r]=e[r].push(m),l.emit("model-created-property",{currentModel:e,pathElement:r,indexElement:s,schema:n.schema.value}),console.log("trollo2")):e[r][s]=m),0!==o.length?t(e[r][s],o,a,d,n):e[r][s]=__spreadValues(__spreadValues({},e[r][s]),m)};return{model:a,schema:d,handleBlur:e=>{console.log("blur",e)},handleChange:e=>{console.log("change",e);let o=a.value,d=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(a.value,e.schemaModelPath,e.schemaModelIndex,d,e):(o[d]=e.value,l.emit("change-model",o,e.schema.value))},handleInput:e=>{console.log(e);let o=a.value,d=e.schema.value.model;e.hasOwnProperty("schemaModelPath")&&e.hasOwnProperty("schemaModelIndex")?t(a.value,e.schemaModelPath,e.schemaModelIndex,d,e):(console.log(e.value),o[d]=e.value,l.emit("change-model",o,e.schema.value))},handleAddGroup:e=>{console.log("add",e),e.customEvent.schemaModelPath,e.customEvent.schemaModelIndex},id:n}}});B.render=function(e,l,a,d,n,t){const r=o.resolveComponent("form-field");return o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(e.schema,((l,a)=>(o.openBlock(),o.createBlock("div",{key:`root-field-${a}`},[o.createVNode(r,{model:e.model,schema:l,id:l.model,onBlured:e.handleBlur,onChangeModel:e.handleChange,onFormInput:e.handleInput,onAddGroupElement:e.handleAddGroup},null,8,["model","schema","id","onBlured","onChangeModel","onFormInput","onAddGroupElement"])])))),128)},e.FormVuelator=B,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
